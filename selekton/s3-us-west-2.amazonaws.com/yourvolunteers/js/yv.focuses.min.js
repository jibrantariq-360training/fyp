function select_focus(b){$("#loading").show();$.cookie("yv_jayne_cobb",b,{path:"/"});$.get("/rest/FocusService/Level/"+b,function(a){$.cookie("yv_serenity",a,{path:"/"});a=startMessagePacket();a[4]="2";processLogging(a,function(a){switch(a){case "token":alert(getTokenAlert());$("#loading").hide();break;case "failed":alert("There was a problem selecting the volunteer focus. Please refresh the page and try again.");$("#loading").hide();break;case "success":window.location.href="/vol/dashboard"}})})}
function loadFocusInfo(){$("#loading").show();var b=startMessagePacket();getFocusBasicInfo(b,function(a){$("#focus_title").val(a[0]);$("#brief_desc").val(a[1]);$("#min_hours").val(a[2]);$("#loading").hide()})}function getFocusBasicInfo(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/FocusInfo",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("error")}})}
function setFocusLogo(){var b="/rest/FocusService/Logo/"+$.cookie("yv_jayne_cobb");$.get(b,function(a){""!=a?$("#logo_image").html("<img src='https://s3-us-west-2.amazonaws.com/yourvolunteers/logos/logo__"+a+"' alt='logo' />"):$("#logo_image").html("")})}function getPublicCalendarStatus(b,a){$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/PublicCalendarStatus/"+b,async:!1,success:a,failure:function(a){alert("error")}})}
function getFocusTitle(b,a){$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/FocusTitle/"+b,async:!1,success:a,failure:function(a){alert("error")}})}function getFocusLockStatus(b,a){$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/LockStatus/"+b,async:!1,success:a,failure:function(a){alert("error")}})}
function loadVolunteerFocuses(){$("#loading").show();var b=startMessagePacket();getVolunteerFocuses(b,function(a){$("#active_focuses").html(buildVolunteerFocusTable(a));$("#loading").fadeOut("slow")})}function getVolunteerFocuses(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/ListFocuses",data:JSON.stringify({messagePacket:b}),dataType:"json",success:a})}
function buildVolunteerFocusTable(b){var a=[];$.each(b,function(b,d){a.push('<div class="row show-grid">');a.push('<div class="col-xs-2">');a.push('<a href="#" class="btn btn-default" ');a.push("onclick=\"return select_focus('");a.push(d[0]);a.push("')\">Select</a>");a.push("</div>");a.push('<div class="col-xs-4"><b>');a.push(d[1]);a.push("</b>");a.push("</div>");if(null!=d[3]&&"2001-01-01 00:00:00.0"!=d[3]){var e=moment(d[3]);a.push(formatYVDateTime(e))}a.push("</div>");a.push("</div>")});return a.join("")}
function focusLockStatusHTML(b){var a=[];switch(b){case 0:a.push("<img id='lockImg' src='http://s3-us-west-2.amazonaws.com/yourvolunteers/images/lock_green_small.png' ");a.push("alt='Lock Icon' align='left' width='46' height='50' hspace='10'/>");a.push("<b>UNLOCKED</b>. Volunteers are able to change their schedules.");break;case 1:a.push("<img id='lockImg' src='http://s3-us-west-2.amazonaws.com/yourvolunteers/images/lock_red_small.png' "),a.push("alt='Lock Icon' align='left' width='46' height='50' hspace='10'/>"),
a.push("<b>LOCKED</b>. Volunteers are NOT able to change their schedules.")}return a.join("")}function getFocusContacts(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/ManagerFocusService/Contacts",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("error getting contacts.")}})}
function loadLoginPage(){var b=window.location.href.split("?")[1];if(null!=b&&0>b.indexOf("error")){$("#loading").show();var a=[];a[0]=$("#malcom_reynolds").text();a[1]=$("#river_tam").text();a[2]=$("#inara_serra").text();a[3]=b;getLoginPageInfo(a,function(c){$("#register_block").show();$("h2").text(c[0]);$("#client_content").html(c[1].replace(/(?:\r\n|\r|\n)/g,"<br />"));$("#register_link").html("<a href='/vol/register?e="+b+"&m="+a[0]+"&r="+a[1]+"'>Register</a>");""!=c[2]?$("#logo").html("<img src='https://s3-us-west-2.amazonaws.com/yourvolunteers/logos/logo__"+
c[2]+"' alt='organization logo'>"):$("#logo").html("");$("#loading").hide()})}else $("#client_content").html("This login page assumes that you are already registered as a volunteer for an organization. If you need to register, then contact your volunteer manager for the correct URL.")}
function getLoginPageInfo(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/LoginPage",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("error getting focus page info.")}})}
function loadRegisterPage(){var b=getQuerystring("e");if(null!=b&&""!=b){$("#loading").show();var a=[];a[0]=$("#malcom_reynolds").text();a[1]=getQuerystring("r");a[2]=getQuerystring("m");a[3]=b;getLoginPageInfo(a,function(a){$("h2").text("Register - "+a[0]);$.getJSON("/rest/ContentService/ClientContent/"+b+"/6",function(a){$("#client_content").html(a)});""!=a[2]?$("#logo").html("<img src='https://s3-us-west-2.amazonaws.com/yourvolunteers/logos/logo__"+a[2]+"' alt='organization logo'>"):$("#logo").html("");
$("#loading").hide()})}$("#input_password").pStrength({changeBackground:!1,onPasswordStrengthChanged:function(a,b){$(this).val()?$.fn.pStrength("changeBackground",$(this),a):$.fn.pStrength("resetStyle",$(this));$("#"+$(this).data("display")).html("Your password strength is "+b+"%.")},onValidatePassword:function(a){$("#"+$(this).data("display")).html($("#"+$(this).data("display")).html()+" Great, now keep it somewhere safe!");$("#myForm").submit(function(){return!0})}})}
function processRegister(){$("#loading").show();if(!registrationValidation())return $("#loading").hide(),!1;var b=[];b[0]=$("#malcom_reynolds").text();b[1]=getQuerystring("r");b[2]=getQuerystring("m");b[3]=getQuerystring("e");var a=new buildVolunteerPacket;checkUsername($("#input_username").val(),$("#malcom_reynolds").text(),function(c){if("failed"==c)return $("#error_message").text("The username you selected is not available. Please select another one."),$("#error_block").show(),$("#input_username").val(""),
$("#input_username").focus(),$("#loading").hide(),!1;$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/Add",data:JSON.stringify({messagePacket:b,volPacket:a}),dataType:"text",success:function(a){"okay"==a&&($("#form_wrapper").hide(),$("#success_message").html("<h3>Success! <a href='https://yourvolunteers.com/vol?"+b[3]+"'>Login Now</a>.</h3>"),$("#success_message").show(),$("#loading").hide())}})})}
function buildVolunteerPacket(){var b=[];b[0]=$("#input_username").val();b[1]=$("#input_password").val();b[2]=$("#input_first").val();b[3]=$("#input_last").val();b[4]=$("#input_email").val();return b}
function registrationValidation(){return""==$("#input_username").val()||""==$("#input_password").val()||""==$("#input_password2").val()||""==$("#input_first").val()||""==$("#input_last").val()||""==$("#input_email").val()?($("#error_message").text("All fields are required."),$("#error_block").show(),!1):$("#input_password").val()!=$("#input_password2").val()?($("#error_message").text("Your passwords do not match."),$("#error_block").show(),!1):$("#input_anti_spam").is(":checked")?validEmail($("#input_email").val())?
!0:($("#error_message").text("The email address does not appear to be valid."),$("#error_block").show(),!1):($("#error_message").text("Please check the box to indicate that you are not an automaton of Skynet."),$("#error_block").show(),!1)}function checkUsername(b,a,c){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/CheckUsername",data:JSON.stringify({username:b,token:a}),dataType:"text",success:c})}
function loadAssociatePage(){var b=window.location.href.split("?")[1];if(null!=b&&""!=b){$("#loading").show();var a=[];a[0]=$("#malcom_reynolds").text();a[1]=$.cookie("yv_river_tam");a[2]=$.cookie("yv_inara_serra");a[3]=b;getLoginPageInfo(a,function(a){$("h2").text("Volunteer - "+a[0]);""!=a[2]?$("#logo").html("<img src='https://s3-us-west-2.amazonaws.com/yourvolunteers/logos/logo__"+a[2]+"' alt='organization logo'>"):$("#logo").html("");$("#loading").hide()})}}
function processAssociation(){var b=window.location.href.split("?")[1];null!=b&&""!=b&&($("#loading").show(),$.cookie("yv_jayne_cobb",b,{path:"/"}),b=startMessagePacket(),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/Associate",data:JSON.stringify({messagePacket:b}),dataType:"text",success:function(a){"okay"==a?window.location.href="/vol/dashboard":alert("There was an issue.");$("#loading").hide()}}))}
function processLogging(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/Logging",data:JSON.stringify({messagePacket:b}),async:!1,statusCode:{200:function(b){a("success")},400:function(b){a("failed")},403:function(b){a("token")}}})}
function loadWizardCheck(){var b=startMessagePacket();async.parallel([function(a){wizardCheckLocked(b)},function(a){wizardCheckTimeblocks(b)},function(a){wizardCheckInterests(b)},function(a){wizardCheckGroups(b)},function(a){wizardCheckNonscheduled(b)}],function(a,b){console.log("parallel done")})}
function wizardGreenCheck(){var b=[];b.push('<button type="button" class="btn btn-default btn-lg" style="margin-right: 15px">');b.push('<span style="color: green" class="glyphicon glyphicon-ok"></span>');b.push("</button>");return b.join("")}function wizardRedX(){var b=[];b.push('<button type="button" class="btn btn-default btn-lg" style="margin-right: 15px">');b.push('<span style="color: red" class="glyphicon glyphicon-remove"></span>');b.push("</button>");return b.join("")}
function wizardCheckLocked(b){var a=[];getFocusLockStatus(b[3],function(b){"false"==b?(a.push(wizardGreenCheck()),a.push("This volunteer focus is not locked; therefore you are able to add shifts.")):(a.push(wizardRedX()),a.push("This volunteer focus is locked; therefore you cannot add shifts. "),a.push("If you find one you want, you will need to contact your volunteer manager."));$("#locked_content").html(a.join(""));a=null})}
function wizardCheckTimeblocks(b){var a=[];getTimeBlocksCallback(b,function(b){0<b.length?(a.push(wizardGreenCheck()),a.push("This volunteer focus uses availability time blocks. All good.")):(a.push(wizardRedX()),a.push("This volunteer focus does not use availability time blocks so there "),a.push("really is not a reason to use this wizard. You can still select shifts by "),a.push("choosing one of the options below Shifts on the menu."));$("#tb_content").html(a.join(""));a=null})}
function wizardCheckInterests(b){var a=[];getInterestsCount(b,function(b){0<b?(a.push(wizardGreenCheck()),a.push("This volunteer focus uses interests. Cool.")):(a.push(wizardRedX()),a.push("This volunteer focus does not use interests. That's okay. "),a.push("The wizard will find shifts based on your availability (if used)."));$("#interests_content").html(a.join(""));a=null})}
function wizardCheckGroups(b){var a=[];getGroupsCount(b,function(c){getGroupsByUser(b,function(b){0<c?(a.push(wizardGreenCheck()),a.push("This volunteer focus uses groups. You are assigned to "),a.push(b.length),a.push(" groups. Note that not all shifts may be limited by groups.")):(a.push(wizardRedX()),a.push("This volunteer focus does not use groups. That's okay. "),a.push("The wizard will find shifts based on your availability (if used) "),a.push("and interests (if used)."));$("#groups_content").html(a.join(""));
a=null})})}function wizardCheckNonscheduled(b){var a=[];getShiftNoSchedCount(b,function(b){0<b?(a.push(wizardGreenCheck()),a.push("This volunteer focus used nonscheduled shifts. Huzzah!")):(a.push(wizardRedX()),a.push("This volunteer focus does not use nonscheduled shifts. "),a.push("Nothing to worry about as long as it uses scheduled shifts."));$("#nonscheduled_content").html(a.join(""));a=null})};