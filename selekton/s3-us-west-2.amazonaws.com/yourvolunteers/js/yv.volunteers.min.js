function checkTermsAndPassword(){var b=startMessagePacket();getStatuses(b,function(a){return 0==a[0]?(window.location.href="terms",!1):1==a[0]&&1==a[1]?(window.location.href="password?from=dash",!1):!0})}
function loadVolunteerContact(b){$("#loading").show();var a=startMessagePacket();"manager"==b?a[4]=getQuerystring("tempid"):"volunteer"==b&&(a[4]=a[1]);a[5]=b;getVolunteerContactInfo(a,function(a){$("#first_name").val(a.firstName);$("#last_name").val(a.lastName);$("#email").val(a.email);$("#org").val(a.org);$("#address1").val(a.address1);$("#address2").val(a.address2);$("#city").val(a.city);$("#state").val(a.state);$("#zip").val(a.zip);$("#day_phone").val(a.dayPhone);$("#evening_phone").val(a.eveningPhone);
$("#mobile_phone").val(a.mobilePhone);$("#country").val(a.country);$("#loading").hide()})}function getVolunteerContactInfo(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/Contact",data:JSON.stringify({messagePacket:b}),dataType:"json",success:a,failure:function(a){alert("error getting contact.")}})}
function updateVolunteer(){if(""==$("#first_name").val()||""==$("#last_name").val()||""==$("#email").val())return alert("Enter values in all fields with the red asterix."),!1;var b=startMessagePacket();b[4]=getQuerystring("tempid");var a=[];a[0]=$("#first_name").val();a[1]=$("#last_name").val();a[2]=$("#email").val();a[3]=$("#org").val();a[4]=$("#address1").val();a[5]=$("#address2").val();a[6]=$("#city").val();a[7]=$("#state").val();a[8]=$("#zip").val();a[9]=$("#day_phone").val();a[10]=$("#evening_phone").val();
a[11]=$("#mobile_phone").val();a[12]=$("#country").val();processUpdate(b,a,function(a){switch(a){case "token":alert(getTokenAlert());$("#loading").hide();break;case "failed":alert("There was an issue updating this volunteer. Please refresh this page and try again.");$("#loading").hide();break;case "success":$("#contact_message").text("Update complete."),$("#contact_message").show(),$("#loading").hide()}})}
function processUpdate(b,a,c){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/Update",data:JSON.stringify({messagePacket:b,volObject:a}),dataType:"json",async:!1,statusCode:{200:function(a){c("success")},400:function(a){c("failed")},403:function(a){c("token")}}})}
function loadVolunteerInterests(b){$("#loading").show();var a=startMessagePacket();getInterestsWithIds(a,function(c){$("#savedAvailableInterests").text(JSON.stringify(c));"manager"==b?a[4]=getQuerystring("tempid"):"volunteer"==b&&(a[4]=a[1]);getVolunteerInterestsCallback(a,function(a){$("#savedAssignedInterests").text(JSON.stringify(a));$("#interests_body").html(buildAssignedInterests(a,"volunteers"));$("#available_interests_body").html(buildAvailableInterests(c,"volunteers"));$("#loading").hide()})})}
function loadWeekAheadStatus(){$("#loading").show();var b=startMessagePacket();getWeekAheadStatus(b,function(a){$("#savedStatus").text(a);$("#email_status").html(buildWeekAheadStatusHTML(a));$("#loading").hide()})}
function buildWeekAheadStatusHTML(b){var a=[];"true"==b?(a.push('<div class="col-xs-1">'),a.push('<img id="emailImg" width="38" hspace="10" height="25" '),a.push('align="right" alt="Email Icon" '),a.push('src="../../s3-us-west-2.amazonaws.com/yourvolunteers/images/emailicon.png">'),a.push("</div>"),a.push('<div class="col-xs-11">'),a.push("<h4>You are receiving the Week Ahead emails.</h4>")):(a.push('<div class="col-xs-1">'),a.push('<img id="emailImg" width="38" hspace="10" height="25" '),a.push('align="right" alt="Email Icon" '),
a.push('src="../../s3-us-west-2.amazonaws.com/yourvolunteers/images/emailicon_not.png">'),a.push("</div>"),a.push('<div class="col-xs-11">'),a.push("<h4>You are NOT receiving the Week Ahead emails.</h4>"));a.push("</div>");return a.join("")}
function getWeekAheadStatus(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/WeekAhead",data:JSON.stringify({messagePacket:b}),dataType:"text",success:a,failure:function(a){alert("error getting week ahead status.")}})}
function updateWeekAhead(){var b=$("#savedStatus").text(),a=startMessagePacket();a[4]="true"==b?"false":"true";$("#savedStatus").text(a[4]);$("#email_status").html(buildWeekAheadStatusHTML(a[4]));"true"==a[4]?createWeekAhead(a,function(a){switch(a){case "token":alert(getTokenAlert());break;case "failed":alert("There was an issue creating the subscription. Please refresh this page and try again.")}}):deleteWeekAhead(a,function(a){switch(a){case "token":alert(getTokenAlert());break;case "failed":alert("There was an issue removing the subscription. Please refresh this page and try again.")}})}
function createWeekAhead(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/NewWeekAhead",data:JSON.stringify({messagePacket:b}),async:!1,statusCode:{200:function(b){a("success")},400:function(b){a("failed")},403:function(b){a("token")}}})}
function deleteWeekAhead(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/DeleteWeekAhead",data:JSON.stringify({messagePacket:b}),async:!1,statusCode:{200:function(b){a("success")},400:function(b){a("failed")},403:function(b){a("token")}}})}
function loadDashboard(){if(0==checkTermsAndPassword())return!1;var b=startMessagePacket(),a=moment(new Date),c=a.subtract("months",3).format("YYYY-MM")+"-01 00:00:00",a=moment(new Date),d=a.add("days",31),a=d.format("YYYY-MM-DD")+" 00:00:00";b[4]=b[1];getVolunteerNameAndUsernameCallback(b,function(a){getFocusTitle(b[3],function(b){$("h2").html(b+"<br />"+a[0]+" "+a[1]+" ("+a[2]+")")})});getInterestCounts(b,function(a){a=$.parseJSON(a);var c="",c=0==a[0]?"<h4>This volunteer focus does not use interests.":
"<h4>You have indicated <a href='interests'>"+a[1]+" interest(s)</a>.";$("#counts_interests").html(c);getCustomAndEmailStatuses(b,function(a){var b=!1,c=!1;0<a[0]&&(b=!0);0<a[1]&&(c=!0);var e=[];0<a[2]&&(b?e.push("<h4>You have answered the <a href='customs'>managers' questions</a>.</h4>"):window.location.href="/vol/customs");c?e.push("<h4>You are signed up to receive <a href='weekahead'>The Week Ahead emails</a>.</h4>"):e.push("<h4>You are NOT signed up to receive <a href='weekahead'>The Week Ahead emails</a>.</h4>");
$("#answered_custom").html(e.join(""))})});getFocusLockStatus(b[3],function(a){"true"==a?$("#lockedContent").html(focusLockStatusHTML(1)):"false"==a&&$("#lockedContent").html(focusLockStatusHTML(0))});getFocusContacts(b,function(a){var b=[];b.push("<h4>Contacts</h4>");$.each(a,function(a,c){b.push(c.name);b.push("<br />");b.push(c.phone);b.push("<br />");b.push(c.email);b.push("<br /><br />")});$("#focus_contacts").html(b.join(""))});b[5]=c;b[6]=a;getVolunteerSummarySchedule(b,function(a){getVolunteerSummaryTracking(b,
function(b){var g=buildShiftCountSummary(a,b,d);$("#past_counts_div").html(g[0]);$("#future_counts_div").html(g[1]);buildVolunteerSummaryChart(a,b,c)})})}function getInterestCounts(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/InterestsService/Counts",data:JSON.stringify({messagePacket:b}),dataType:"text",success:a,failure:function(a){alert("error getting interest counts.")}})}
function getCustomAndEmailStatuses(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/CustomAndEmailStatuses",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("Error getting statuses.")}})}
function buildVolunteerSummaryChart(b,a,c){c=moment(c);var d=new google.visualization.DataTable;d.addColumn("string","Month");d.addColumn("number","Scheduled");d.addColumn("number","Tracked");for(var m=0;4>m;m++){var e=c.format("MMMM"),g=0,h=0,k=moment(c),l=moment(c.add("months",1));$.each(b,function(b,c){var d=moment(c[1]),f=moment(c[2]);if(d>=k&&f<l){g+=f.diff(d,"hours",!0);var e=!1;$.each(a,function(a,b){if(b[0]==c[0]){e=!0;var d=moment(b[1]),f=moment(b[2]);h+=f.diff(d,"hours",!0)}});e||"true"==
c[4]&&(h+=f.diff(d,"hours",!0))}});d.addRow([e,g,h])}(new google.visualization.BarChart(document.getElementById("counts_chart"))).draw(d,{title:"Last Four Months",width:700,height:500,colors:["#4ca747","#f89f2b"],vAxis:{title:"Month"},hAxis:{title:"Hours"}})}
function getVolunteerSummarySchedule(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/SchedulingService/VolunteerSummarySchedule",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("Error loading shift groups.")}})}
function getVolunteerSummaryTracking(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/SchedulingService/TrackingByUserByRange",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("Error loading tracking info.")}})}
function getVolunteerSummaryTrackingNoSched(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/SchedulingService/VolunteerTrackingNoSchedMinRange",data:JSON.stringify({messagePacket:b}),dataType:"json",async:!1,success:a,failure:function(a){alert("Error loading tracking info.")}})}
function buildShiftCountSummary(b,a,c){var d=moment(new Date),m=moment().subtract("days",30),e=0,g=0,h=0,k=0,l=0,p=0;$.each(b,function(b,n){var f=moment(n[1]),r=moment(n[2]);if(f>m&&f<d)if("true"==n[4]){var s=!1,q=0;$.each(a,function(a,b){if(n[0]==b[0]){s=!0;var c=moment(b[1]);q=moment(b[2]).diff(c,"hours",!0);c>f&&(p+=1)}});s||(q=r.diff(f,"hours",!0));e+=1;g+=q}else l+=1;f<c&&f>d&&(h+=1,k+=r.diff(f,"hours",!0))});b=[];b[0]="<h3>Past 30 Days</h3><h4>"+e+" Shifts</h4><h4>"+g.toFixed(2)+" Hours</h4><h4>"+
l+" No Shows</h4><h4>"+p+" Time(s) Late</h4>";b[1]="<h3>Upcoming 30 Days</h3><h4>"+h+" Shifts</h4><h4>"+k.toFixed(2)+" Hours</h4>";return b}
function getVolunteerNameAndUsername(){var b=startMessagePacket();b[4]=getQuerystring("tempid");$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/VolunteerNameAndUsername",data:JSON.stringify({messagePacket:b}),dataType:"json",success:function(a){3==a.length&&$("h2").text(a[0]+" "+a[1]+" ("+a[2]+")")},failure:function(a){alert("error")}})}
function getVolunteerNameAndUsernameCallback(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/VolunteerNameAndUsername",data:JSON.stringify({messagePacket:b}),dataType:"json",success:a,failure:function(a){alert("error getting name.")}})}
function getStatuses(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/TermsAndPassword",data:JSON.stringify({messagePacket:b}),dataType:"json",success:a,failure:function(a){alert("error getting statuses.")}})}function processTerms(){var b=startMessagePacket();processTermsAccept(b,function(a){"okay"==a&&(window.location.href="dashboard")})}
function processTermsAccept(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/AcceptTerms",data:JSON.stringify({messagePacket:b}),dataType:"text",success:a,failure:function(a){alert("error accepting terms.")}})}
function getVolunteerActivitySummary(b,a){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/VolunteerService/ActivitySummary",data:JSON.stringify({messagePacket:b}),dataType:"json",success:a,failure:function(a){alert("error getting summary.")}})};