function createCheck(){$("#anti_spam").prepend("<input type='checkbox' id='input_anti_spam' value='on' style='margin-right: 10px'>")}
function clearSession(){$.removeCookie("yv_river_tam",{path:"/"});$.removeCookie("yv_inara_serra",{path:"/"});$.removeCookie("yv_jayne_cobb",{path:"/"});$.removeCookie("yv_serenity",{path:"/"});$.removeCookie("yv_jayne_cobb",{path:"/vol/"});$.removeCookie("yv_river_tam",{path:"/vol/"});$.removeCookie("yv_inara_serra",{path:"/vol/"});$.removeCookie("yv_serenity",{path:"/vol/"});$.removeCookie("yv_jayne_cobb",{path:"/manager/"});$.removeCookie("yv_river_tam",{path:"/manager/"});$.removeCookie("yv_inara_serra",
{path:"/manager/"});$.removeCookie("yv_serenity",{path:"/manager/"})}
function validateLogin(a){if(""==$("#input_username").val()||""==$("#input_password").val()||!$("#input_anti_spam").is(":checked"))return $("#error_block").show(),""==$("#input_username").val()||""==$("#input_password").val()?$("#error_message").text("Please enter a username and password."):""==$("#input_username").val()&&""==$("#input_password").val()||$("#input_anti_spam").is(":checked")||$("#error_message").text("Please check the box to verify that you are not an unfeeling robot incapable of checking boxes."),!1;
switch(a){case "manager":processManagerLogin();break;case "volunteer":processVolunteerLogin()}}
function processManagerLogin(){$("#loading").show();var a=[];a[0]=$("#malcom_reynolds").text();a[1]=$("#river_tam").text();a[2]=$("#inara_serra").text();a[3]=$("#jayne_cobb").text();a[4]=$("#input_username").val();a[5]=$("#input_password").val();processLogin(a,function(a){if("bad token"==a[0])return $("#loading").hide(),alert(getTokenAlert()),!1;if("bad keys"==a[0])return window.location.href="manager?error=failedlogin",!1;$.cookie("yv_river_tam",a[0]);$.cookie("yv_inara_serra",a[1]);window.location.href=
"http://yourvolunteers.com/manager/focuses"})}
function processVolunteerLogin(){$("#loading").show();var a=[];a[0]=$("#malcom_reynolds").text();a[1]=$("#river_tam").text();a[2]=$("#inara_serra").text();a[3]=$("#jayne_cobb").text();a[4]=$("#input_username").val();a[5]=$("#input_password").val();processLogin(a,function(a){if("bad token"==a[0])return $("#loading").hide(),alert(getTokenAlert()),!1;if(""==a[0]||""==a[1])window.location.href="vol5fc5.html?error=failedlogin";$.cookie("yv_river_tam",a[0],{path:"/"});$.cookie("yv_inara_serra",a[1],{path:"/"});
var b=window.location.href.split("?")[1];null!=b&&0>b.indexOf("error")?checkForAssociation(a[0],b,function(a){$.get("/rest/FocusService/Level/"+b,function(c){$.cookie("yv_serenity",c,{path:"/"});"false"==a?window.location.href="http://yourvolunteers.com/vol/associate?"+b:($.cookie("yv_jayne_cobb",b,{path:"/"}),window.location.href="../volb53b.html")})}):window.location.href="http://yourvolunteers.com/vol/focuses"})}
function checkForAssociation(a,c,b){var d=[];d[0]=$("#malcom_reynolds").text();d[1]=a;d[2]=c;$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/FocusService/IsAssociated",data:JSON.stringify({messagePacket:d}),dataType:"text",async:!1,success:b,failure:function(a){alert("error getting association status.")}})}
function processLogin(a,c){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/CheckLogin",data:JSON.stringify({messagePacket:a}),dataType:"json",success:c})}
function processPassword(){if(""==$("#new_password1").val()||""==$("#new_password2").val()||""==$("#old_password").val())return alert("All fields are required."),!1;if($("#new_password1").val()!=$("#new_password2").val())return alert("Your new passwords do not match."),$("#new_password1").val(""),$("#new_password2").val(""),$("#new_password1").focus(),!1;var a=startMessagePacket();a[4]=$("#old_password").val();a[5]=$("#new_password1").val();passwordUpdate(a,function(a){switch(a){case "oldfailed":alert("Your old password is incorrect.");
$("#old_password").val("");$("#old_password").focus();break;case "updatefailed":alert("There was a problem with the update. Please try again.");break;case "okay":"dash"==getQuerystring("from")&&(window.location.href="dashboard"),$("#old_password").val(""),$("#new_password1").val(""),$("#new_password2").val(""),$("#customs_message").html("Your password has been updated."),$("#customs_message").show()}})}
function passwordUpdate(a,c){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/UpdatePassword",data:JSON.stringify({messagePacket:a}),dataType:"text",success:c})}
function resetPassword(){""!=$("#email_address").val()&&validEmail($("#email_address").val())?$("#input_anti_spam").is(":checked")?($("#loading").show(),checkLoginEmail($("#email_address").val(),$("#malcom_reynolds").text(),function(a){"failed"==a?($("#reset_message").text("This email address is not in our system. If you are sure that you are registered, contact your volunteer manager."),$("#reset_message").show(),$("#loading").hide()):"okay"==a&&resetPasswordProcess($("#email_address").val(),$("#malcom_reynolds").text(),
function(a){switch(a){case "token":alert(getTokenAlert());$("#loading").hide();break;case "failed":alert("There was an issue. Please refresh this page and try again.");$("#loading").hide();break;case "success":$("#reset_message").removeClass("alert-danger"),$("#reset_message").addClass("alert-success"),$("#reset_message").text("Your temporary password has been sent by email."),$("#reset_message").show(),$(".btn").hide(),$("#loading").hide()}})})):($("#reset_message").text("Please check the box to verify that you are not a robot incapable of checking boxes."),
$("#reset_message").show()):($("#reset_message").text("Enter a valid email address."),$("#reset_message").show())}function checkLoginEmail(a,c,b){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/CheckEmail",data:JSON.stringify({email:a,token:c}),dataType:"text",success:b})}
function resetPasswordProcess(a,c,b){$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"/rest/LoginService/ResetPassword",data:JSON.stringify({email:a,token:c}),async:!1,statusCode:{200:function(a){b("success")},400:function(a){b("failed")},403:function(a){b("token")}}})}
function checkForErrors(){var a=getQuerystring("error");"notauser"==a||"failedlogin"==a?($("#error_message").text("Your login information is not correct. Please try again."),$("#error_block").show()):"time"==a?($("#error_message").text("Your session has timed out. Please login again."),$("#error_block").show()):"notamanager"==a||"nofocus"==a?($("#error_message").text("You are not currently a manager for any volunteer focus."),$("#error_block").show()):"notassoc"==a&&($("#error_message").text("You login information may not be correct or you may not be associated with this volunteer focus. Please try logging in again."),
$("#error_block").show())}function testForIE(){var a=-1;Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject||"Microsoft Internet Explorer"!=navigator.appName||(null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(a=parseFloat(RegExp.$1)),-1<a&&10>a&&alert("We are sorry, but this website uses some of the newer technologies which will not be accessible in your current browser. Please use a modern browser like Google Chrome 33 or Firefox 28."))};